---
- name: Configure Azure NSG
  hosts: localhost

  tasks:
    - name: Ensure Azure NSG exists
      azure.azcollection.azure_rm_securitygroup:
        resource_group: "{{ nsg_config.rg }}"
        name: "{{ nsg_config.name }}"
        tags:
          ansible: managed
        purge_rules: true
        rules: "{{ nsg_config.rules }}"
